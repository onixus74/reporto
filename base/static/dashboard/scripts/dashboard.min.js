!function(){"use strict";function a(){$(document).ready(reform.widgets.map),$(document).ready(reform.widgets.paginators),$(document).ready(reform.widgets.search),reform.widgets.charts.reportsByDate(),reform.widgets.charts.violationsByCategory(),reform.widgets.charts.violationsByVictimGender(),reform.widgets.charts.violationsByVictimEducation(),reform.widgets.charts.violationsByFeatures(),reform.widgets.charts.appreciationByCategory()}reform||(window.reform={data:{},urls:{},widgets:{}}),reform.widgets.map=function(){var a=reform.widgets.map=L.map("ui-timeline-map");a.setView([34.161818161230386,9.3603515625],5),a.setMaxBounds(a.getBounds()),a.scrollWheelZoom.disable(),L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png").addTo(a);var b=L.AwesomeMarkers.icon({icon:"flag",markerColor:"red"}),c=L.AwesomeMarkers.icon({icon:"star",markerColor:"green"}),d=new L.MarkerClusterGroup;d.addLayers(reform.data.violationsLocations.map(function(a){var c=L.marker(L.latLng(a.latitude,a.longitude),{title:a["category__definition_"+reform.i18n.language],icon:b});return c.bindPopup('<a href="'+reform.urls.violationView.replace("0",a.pk)+'" target="_blank">'+a["category__definition_"+reform.i18n.language]+"</a>"),c})),d.addLayers(reform.data.appreciationsLocations.map(function(a){var b=L.marker(L.latLng(a.latitude,a.longitude),{title:a["category__definition_"+reform.i18n.language],icon:c});return b.bindPopup('<a href="'+reform.urls.appreciationView.replace("0",a.pk)+'" target="_blank">'+a["category__definition_"+reform.i18n.language]+"</a>"),b})),a.addLayer(d)},reform.widgets.geosearch=function(){},reform.widgets.paginators=function(){function a(a){a.find(".ui-timeline-story-locator").on("click",function(a){a.stopPropagation(),a.preventDefault();var b=$(a.target).closest("li"),c=new L.LatLng(b.data("latitude"),b.data("longitude"));reform.widgets.map.setView(c,20),$.scrollTo(reform.widgets.map._container,500,{axis:"y",offset:{top:-100}})}),a.tooltip({selector:"[data-toggle=tooltip]",container:"body"})}function b(a,b){a.find(".ui-timeline-story-link").on("click",function(a){a.stopPropagation(),a.preventDefault();var c=$(a.target).closest("a"),d=c.attr("href");b.find(".modal-footer .ui-more").attr("href",d),$.get(d+"/partial").done(function(a){b.find(".modal-body").html(a),b.modal("show")})})}function c(c,d){return function(e,f){reform.widgets.paginate(c,e,f,function(c){a(c),b(c,d)})}}function d(a,b,c){return function(){a.block(),$.getJSON(c).done(function(d){console.log(d),a.html(d.html),b(d,c),a.unblock()})}}var e=$("#ui-violations-timeline-list"),f=e.find(".ui-list"),g=c(f,$("#ui-violation-view-modal")),h=d(f,g,reform.urls.violationsDashboard);g(reform.data.violationsPagination,reform.urls.violationsDashboard),reform.widgets.paginateSearch(e,reform.urls.violationsSearch,g,h);var i=$("#ui-appreciations-timeline-list"),j=i.find(".ui-list"),k=c(j,$("#ui-appreciation-view-modal")),l=d(j,k,reform.urls.appreciationsDashboard);k(reform.data.appreciationsPagination,reform.urls.appreciationsDashboard),reform.widgets.paginateSearch(i,reform.urls.appreciationsSearch,k,l)},a()}();
//# sourceMappingURL=/static/dashboard/scripts/dashboard.min.js.map