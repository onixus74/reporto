{% extends "layouts/default.html" %}

{% load widget_tweaks static custom compress %}


{% block view_title %}Sign in | {% endblock %}

{% block view_content %}
	<div class="panel text-center">

		<div class="panel_" style="margin-top: 20px; width: auto; display: inline-block;">

      <div class="jumbotron">
        <h1>Reform Reporting Platform</h1>
        <p class="lead">a tool to monitor security sector status by tracking violations involving police officers</p>
        <p class="lead">
          <h2><span class="text-muted animatable animated">{{violations_count|add:appreciations_count}}</span> reports</h2>
          <h3><span class="text-danger animatable animated">{{violations_count}}</span> violations - <span class="text-success animatable animated">{{appreciations_count}}</span> appreciations</h3>
        </p>
      </div>

			{% comment %}
			{% if form.errors %}
			<div class="alert alert-danger">
				<button type="button" class="close" data-dismiss="alert">&times;</button>
				Your username and password didn't match. Please try again.</p>
			</div>
			{% endif %}
			{% endcomment %}


			{% if form.errors %}
			<div class="alert alert-danger">
				<button type="button" class="close" data-dismiss="alert">&times;</button>
				{% for field, errors in form.errors.items %}
					<div class="field-{{field}}">{% for error in errors %} {{error}}{% endfor %}</div>
				{% endfor %}
			</div>
			{% endif %}

			<p class="lead">contribute by signing in</p>

      <div class="row">
        <div class="col-md-8 col-md-offset-2">

    			<form class="form-inline_" method="post" role="form">
    				{% csrf_token %}

            <div class="form-group">
              <div class="input-group input-group-lg">
                <span class="input-group-addon"><i class="fa fa-envelope"></i></span>
                {% render_field form.username type="email" placeholder="Email" required="required" -autofocus="autofocus" class="form-control" %}
              </div>
            </div>

            <div class="form-group">
              <div class="input-group input-group-lg">
                <span class="input-group-addon"><i class="fa fa-key"></i></span>
                {% render_field form.password placeholder="Password" required="required" class="form-control" %}
              </div>
            </div>

    				<input type="hidden" name="next" value="{{ next }}" />

            <button class="btn btn-default btn-lg btn-block" name="commit" type="submit">
              Sign in <i class="fa fa-sign-in"></i>
            </button>
            <a href="{% url 'password_reset' %}" class="btn btn-link">Reset your password</a>

    			</form>

        </div>

      </div>

      <div class="row" style="margin-top: 20px">
        <div class="col-md-4 col-md-offset-2">
          <a href="{% url 'socialauth_begin' 'facebook' %}?next={{next}}" class="btn btn-facebook btn-block"><i class="fa fa-facebook-square"></i> Facebook</a>
        </div>
        <div class="col-md-4">
          <a href="{% url 'socialauth_begin' 'google' %}?next={{next}}" class="btn btn-google btn-block"><i class="fa fa-google-plus-square"></i> Google</a>
        </div>
      </div>

      <div class="row" style="margin-top: 20px">
        <div class="col-md-8 col-md-offset-2">
          <p class="lead text-center"><a href="{% url 'signup' %}?next={{next}}">Sign up using email</a> if you do not have an account yet.</p>
        </div>
      </div>

			<!--<p class="text-center">or <a href="/signup">create an account</a></p>-->

		</div>


    <div class="row">
      <div class="col-md-6" style="margin-top: 20px;">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h2 class="panel-title">Violations</h2>
          </div>
          <div class="panel-body">
            <div>
              <h3>Latest Reports</h3>
              <div class="list-group text-left">
              {% for report in violations_latest %}
                <a class="list-group-item" href="{{report.get_absolute_url}}">
                  {{report.category}} at {{report.location_text}} on
                    {{report.datetime}}
                  {% if report.is_verified %}<span class="label label-success">Verified <i class="fa fa-ok"></i></span>{% endif %}
                </a>
              {% empty %}
                <a class="list-group-item">None!</a>
              {% endfor %}
              </div>
            </div>
            <div>
              <h3>Top Reporters</h3>
              <ul class="list-group text-left">
              {% for user in violations_top_reporters %}
                <li class="list-group-item">
                  <span class="badge">{{user.count}}</span>
                  {{user.get_full_name}}
                </li>
              {% empty %}
                <li class="list-group-item">None!</li>
              {% endfor %}
              </ul>
            </div>
            <div>
              <h3>Top Reporting Circles</h3>
              <ul class="list-group text-left">
              {% for group in violations_top_reporting_circles %}
                <li class="list-group-item">
                  <span class="badge">{{group.count}}</span>
                  {{group.name}}
                </li>
              {% empty %}
                <li class="list-group-item">None!</li>
              {% endfor %}
              </ul>
            </div>
            <a class="btn btn-danger btn-lg" href="{% url 'violations:submit' %}" style="margin: 10px"><i class="fa fa-plus"></i> Report a Violation</a>
          </div>
        </div>
      </div>
      <div class="col-md-6" style="margin-top: 20px;">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h2 class="panel-title">Appreciations</h2>
          </div>
          <div class="panel-body">
            <div>
              <h3>Latest Reports</h3>
              <div class="list-group text-left">
              {% for report in appreciations_latest %}
                <a class="list-group-item" href="{{report.get_absolute_url}}">
                  {{report.category}} for {{report.target}}, {{report.datetime}} at {{report.location_text}}
                </a>
              {% empty %}
                <a class="list-group-item">None!</a>
              {% endfor %}
              </div>
            </div>
            <div>
              <h3>Top Reporters</h3>
              <ul class="list-group text-left">
              {% for user in appreciations_top_reporters %}
                <li class="list-group-item">
                  <span class="badge">{{user.count}}</span>
                  {{user.get_full_name}}
                </li>
              {% empty %}
                <li class="list-group-item">None!</li>
              {% endfor %}
              </ul>
            </div>
            <div>
              <h3>Top Reporting Circles</h3>
              <ul class="list-group text-left">
              {% for group in appreciations_top_reporting_circles %}
                <li class="list-group-item">
                  <span class="badge">{{group.count}}</span>
                  {{group.name}}
                </li>
              {% empty %}
                <li class="list-group-item">None!</li>
              {% endfor %}
              </ul>
            </div>
            <a class="btn btn-success btn-lg" href="{% url 'appreciations:submit' %}" style="margin: 10px"><i class="fa fa-plus"></i> Appreciate Police Work</a>
          </div>
        </div>
      </div>
    </div>

		<div class="row">
			<div class="col-md-6" style="margin-top: 20px;">
				<div id="ui-reports-dates-chart"></div>
			</div>
			<div class="col-md-6" style="margin-top: 20px;">
				<div id="ui-stats-features-chart"></div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-4" style="margin-top: 20px;">
				<div id="ui-stats-categories-chart"></div>
			</div>
			<div class="col-md-4" style="margin-top: 20px;">
				<div id="ui-stats-victim-gender-chart"></div>
			</div>
			<div class="col-md-4" style="margin-top: 20px;">
				<div id="ui-stats-victim-education-chart"></div>
			</div>
		</div>

	</div>
{% endblock %}

{% block view_scripts %}
	<script type="text/javascript">
		reform.urls.statistics = {% url 'public_statistics' as url %}{{url|json}};
	</script>
	{% compress js %}
	<script src="{% static 'components/highcharts.com/js/highcharts.src.js' %}"></script>
	<script src="{% static 'components/highcharts.com/js/modules/exporting.src.js' %}"></script>
  <script src="{% static 'scripts/highcharts-theme.js' %}"></script>
	<script src="{% static 'users/scripts/login.js' %}"></script>
  <script type="text/javascript">
  $(document).ready(function(){
    $('.jumbotron .animatable').each(function(i, e){
      setTimeout(function(){$(e).addClass('pulse')}, i * 500);
    });
  });
  </script>
	{% endcompress %}
{% endblock %}

{% block view_styles %}
  {% compress css %}
  <link rel="stylesheet" href="{% static 'users/styles/login.css'%}" />
  {% endcompress %}
{% endblock %}
