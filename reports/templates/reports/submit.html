{% extends "layouts/default.html" %}

{% load static %}
{% load json %}
{% load crispy_forms_tags %}
{% load widget_tweaks %}
{% load compress %}

{% block view_title %}Report Submission | {% endblock %}

{% block view_content %}
	<form id="report-form" action="{% url 'reports:submit' %}" method="post" enctype="multipart/form-data">
		{% csrf_token %}

	<div class="container">

		{% if form.errors %}
		<div class="alert alert-error">
			<button type="button" class="close" data-dismiss="alert">&times;</button>
			{% for field, errors in form.errors.items %}
				<div>{{field}}:{% for error in errors %} {{error}}{% endfor %}</div>
			{% endfor %}
		</div>
		{% endif %}

		<div class="well report-incident-form">

			<div class="container-fluid">

				<div class="row-fluid">
					<div class="span12">
						<h1 id="wizard-1-header" class="text-center animated">I'm a <div style="display: inline-block" id="ui-wizard-reporter-state">...</div style="display: inline-block"></h1>
						<input id="id_victim" name="victim" type="hidden" value="0">
					</div>
				</div>

				<div class="row-fluid ui-wizard-row" id="ui-wizard-victim-witness-buttons">
					<div class="span6" id="ui-wizard-victim-button-container">
						<a href="javascript:void(0)" class="btn btn-large btn-block btn-warning" id="ui-wizard-victim-button" data-value="victim" data-class="text-warning">Victim</a>
					</div>
					<div class="span6" id="ui-wizard-witness-button-container">
						<a href="javascript:void(0)" class="btn btn-large btn-block btn-success" id="ui-wizard-witness-button" data-value="witness" data-class="text-success" tabindex="0">Witness</a>
					</div>
				</div>

				<div class="row-fluid ui-wizard-row" id="ui-wizard-category-datetime" hidden>
					<div class="offset2 span8 natural-language-form">

						<p class="lead text text-center">
							<span id="ui-wizard-victim-text" hidden>I've been a victim of</span>
							<span id="ui-wizard-witness-text" hidden>I've witnessed a</span>
							{% render_field form.category placeholder="Location" class+="select2 span4" data-style="boostrap-select-colors-fix" required="required" %}
							<!--that happened -->on
							{% render_field form.datetime type="datetime-local" class+="span4" required="required" %}
							<!--at-->
						</p>

					</div>
					<div hidden></div>
				</div>

				<div class="row-fluid ui-wizard-row" id="ui-wizard-location" hidden>
					<div class="offset2 span8">

						<div id="map" style="width:100%; height: 300px"></div>
						<!--<input type="text" name="location" id="id_location">-->
						{% render_field form.location type="hidden" %}

						{% render_field form.location_text type="text" placeholder="Location" class="input-block-level" _data-provide="typeahead" _data-source="reform.data.locations" _autocomplete="off" %}

					</div
					<div hidden></div>
				</div>

				<div class="row-fluid ui-wizard-row" id="ui-wizard-victim" hidden>
					<div class="offset2 span8" id="ui-wizard-victim-area">
						<h2>Victim</h2>

						<!--{{form.victim.as_hidden}}-->

						<fieldset id="ui-victim-fieldset" class="form-horizontal input-area" style="height: auto;">

							<!--{% render_field form.victim placeholder="Victim" class+="select2 input-block-level" %}-->

							{#% {{victim_form|crispy}} %#}

							<div id="div_id_victim-firstname" class="control-group">
							  <label for="id_victim-firstname" class="control-label requiredField">
							  Firstname<span class="asteriskField">*</span></label>
							  <div class="controls"><input class="textinput textInput" id="id_victim-firstname" maxlength="100" name="victim-firstname" type="text" /> </div>
							</div>
							<div id="div_id_victim-lastname" class="control-group">
							  <label for="id_victim-lastname" class="control-label requiredField">
							  Lastname<span class="asteriskField">*</span></label>
							  <div class="controls"><input class="textinput textInput" id="id_victim-lastname" maxlength="100" name="victim-lastname" type="text" /> </div>
							</div>
							<div id="div_id_victim-gender" class="control-group">
							  <label for="id_victim-gender" class="control-label requiredField">
							  Gender<span class="asteriskField">*</span></label>
							  <div class="controls">
							    <select class="select" id="id_victim-gender" name="victim-gender">
							      <option value="M" selected="selected">Male</option>
							      <option value="F">Female</option>
							    </select>
							  </div>
							</div>
							<div id="div_id_victim-age" class="control-group">
							  <label for="id_victim-age" class="control-label requiredField">
							  Age<span class="asteriskField">*</span></label>
							  <div class="controls"><input class="textinput textInput" id="id_victim-age" name="victim-age" type="text" /> </div>
							</div>
							<div id="div_id_victim-education" class="control-group">
							  <label for="id_victim-education" class="control-label requiredField">
							  Education<span class="asteriskField">*</span></label>
							  <div class="controls"><input class="textinput textInput" id="id_victim-education" maxlength="200" name="victim-education" type="text" /> </div>
							</div>
							<div id="div_id_victim-profession" class="control-group">
							  <label for="id_victim-profession" class="control-label requiredField">
							  Profession<span class="asteriskField">*</span></label>
							  <div class="controls"><input class="textinput textInput" id="id_victim-profession" maxlength="200" name="victim-profession" type="text" /> </div>
							</div>
							<div id="div_id_victim-phone" class="control-group">
							  <label for="id_victim-phone" class="control-label requiredField">
							  Phone<span class="asteriskField">*</span></label>
							  <div class="controls"><input class="textinput textInput" id="id_victim-phone" maxlength="20" name="victim-phone" type="text" /> </div>
							</div>
							<div id="div_id_victim-email" class="control-group">
							  <label for="id_victim-email" class="control-label requiredField">
							  Email<span class="asteriskField">*</span></label>
							  <div class="controls"><input class="textinput textInput" id="id_victim-email" maxlength="75" name="victim-email" type="text" /> </div>
							</div>
							<div id="div_id_victim-description" class="control-group">
							  <label for="id_victim-description" class="control-label requiredField">
							  Description<span class="asteriskField">*</span></label>
							  <div class="controls"><textarea class="textarea" cols="40" id="id_victim-description" name="victim-description" rows="10"></textarea></div>
							</div>
							<div id="div_id_victim-category" class="control-group">
							  <label for="id_victim-category" class="control-label ">
							  Category
							  </label>
							  <div class="controls">
							    <select class="select" id="id_victim-category" name="victim-category">
							      <option value="">---------</option>
							      <option value="CIT" selected="selected">Citizen</option>
							      <option value="COP">Cop</option>
							    </select>
							  </div>
							</div>
						</fieldset>

					</div>
					<div hidden></div>
				</div>

				<div class="row-fluid ui-wizard-row" id="ui-wizard-aggressor" hidden>
					<div class="offset2 span8" id="ui-wizard-aggressor-area">
						<h2>Aggressor</h2>
						{% render_field form.aggressor placeholder="Aggressor" class+="input-block-level input-area" %}
					</div>
				</div>

				<div class="row-fluid ui-wizard-row" id="ui-wizard-description-evidence" hidden>
					<div class="span6">
						<h2>Description</h2>
						{% render_field form.description placeholder="Description" class+="input-block-level input-area" %}
					</div>
					<div class="span6">
						<h2>Evidence</h2>
						<!--<input name="files[]" type="file" multiple />-->
						<!--<input type="hidden" name="rsid" value="{{report_submit_id}}">-->
						<div id="assets" tabindex="0" class="dropzone input-area" style="background-color: #FFF; border: 1px solid #999;"></div>
						<!--
						<button type="button" class="input-block-level input-area" style="padding: 0;">
							<div id="assets" class="dropzone" style="background-color: #FFF; height: 100%">
							</div>
						</button>
						-->
					</div>
				</div>

				<div class="row-fluid ui-wizard-row" id="ui-wizard-features" hidden>
					<div class="span12">
						<h2>Features</h2>
						<!--<input type="text" class="input-block-level" placeholder="Features">-->
						{% render_field form.features placeholder="Features" class+="select2 input-block-level" data-style="btn-large"  %}
					</div>
				</div>

				<div class="row-fluid ui-wizard-row" id="ui-wizard-submit" hidden>
					<div class="span12">
						<input type="submit" value="Report" class="btn btn-block btn-info btn-large">
					</div>
				</div>

			</div>
		</div>

	</div>

	</form>

	<div id="ui-wizard-progress-bar" class="progress progress-info progress-striped">
		<div class="bar animated" id="ui-wizard-progress"></div>
	</div>

{% endblock %}

{% block view_styles %}

	{% compress css %}
	<!-- Map -->
	<link rel="stylesheet" href="{% static 'components/leaflet/dist/leaflet.css' %}" />
	<!--[if lte IE 8]>
	<link rel="stylesheet" href="{% static 'components/leaflet/dist/leaflet.ie.css' %}" />
	<![endif]-->
	<link rel="stylesheet" href="{% static 'dependencies/L.GeoSearch/src/css/l.geosearch.css' %}" />

	<link rel="stylesheet" href="{% static 'components/dropzone/downloads/css/basic.css' %}" />
	{% endcompress %}

	<link rel="stylesheet" href="{% static 'reports/styles/submit.css'%}" />

{% endblock %}

{% block view_scripts %}
	<!--
	<script src="{% static 'components/angular/angular.js' %}"></script>

	<script src="{% static 'components/angular-resource/angular-resource.js' %}"></script>
	<script src="{% static 'components/angular-cookies/angular-cookies.js' %}"></script>
	<script src="{% static 'components/angular-sanitize/angular-sanitize.js' %}"></script>
	<script src="{% static 'components/ui-router/release/angular-ui-router.js' %}"></script>
	<script src="{% static 'components/angular-bootstrap/ui-bootstrap-tpls.js' %}"></script>

	<script src="{% static 'scripts/app.js' %}"></script>
	<script src="{% static 'reports/scripts/submit-ng.js' %}"></script>
	-->
	{% compress js %}
	<!-- Map -->
	<script src="{% static 'components/leaflet/dist/leaflet.js' %}"></script>
	<script src="{% static 'dependencies/L.GeoSearch/src/js/l.control.geosearch.js' %}"></script>
	<script src="{% static 'dependencies/L.GeoSearch/src/js/l.geosearch.provider.google.js' %}"></script>

	<script src="{% static 'components/dropzone/downloads/dropzone.js' %}"></script>
	<script src="{% static 'components/typeahead.js/dist/typeahead.js' %}"></script>
	{% endcompress %}

	<script type="text/javascript">
		var report_submit_id = {{report_submit_id|json}};
		reform.data.victims = {{victims|json}};
		reform.data.reports = {{reports|json}};
		reform.urls.submit = {% url 'reports:submit' as submit_url %}{{submit_url|json}};
		reform.urls.upload = {% url 'reports:submit-upload' as upload_url %}{{upload_url|json}};
	</script>

	<script src="{% static 'reports/scripts/submit.js' %}"></script>

{% endblock %}
