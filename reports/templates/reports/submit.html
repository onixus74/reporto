{% extends "layouts/default.html" %}

{% load static json crispy_forms_tags widget_tweaks compress l10n %}

{% block view_title %}Report Submission | {% endblock %}

{% block view_content %}

	<div id="ui-wizard-progress-bar" style="z-index: 1100;">
		<div class="container progress progress-info progress-striped">
			<div class="bar animated" id="ui-wizard-progress"></div>
		</div>
		<!--
		<div class="container">
			<div class="row-fluid">
				<div class="span2">Victim or Witness?</div>
				<div class="span2">Incident Category</div>
				<div class="span2">When and Where?</div>
				<div class="span2">Aggressor</div>
				<div class="span2">Incident Description and Evidence</div>
			</div>
		</div>
	-->
	</div>

	<form id="report-form" action="{% url 'reports:submit' %}" method="post" enctype="multipart/form-data">
		{% csrf_token %}

	<div class="container">

		{% if form.errors %}
		<div class="alert alert-error">
			<button type="button" class="close" data-dismiss="alert">&times;</button>
			{% for field, errors in form.errors.items %}
				<div>{{field}}:{% for error in errors %} {{error}}{% endfor %}</div>
			{% endfor %}
		</div>
		{% endif %}

		<div class="row-fluid">
			<div class="span9">

				<div class="well report-incident-form">

					<div class="row-fluid">
						<div class="span12">
							<h1 id="wizard-1-header" class="text-center animated">I'm a <divspan id="ui-wizard-reporter-state" style="display: inline-block;">...</span></h1>
							<input id="id_victim" name="victim" type="hidden" value="0">
						</div>
					</div>

					<div class="row-fluid ui-wizard-row" id="ui-wizard-victim-witness-buttons">
						<div class="span6" id="ui-wizard-victim-button-container">
							<a href="javascript:void(0)" class="btn btn-large btn-block btn-warning" id="ui-wizard-victim-button" data-value="victim" data-class="text-warning"><i class="icon-user icon-2x"></i> Victim</a>
						</div>
						<div class="span6" id="ui-wizard-witness-button-container">
							<a href="javascript:void(0)" class="btn btn-large btn-block btn-success" id="ui-wizard-witness-button" data-value="witness" data-class="text-success" tabindex="0"><i class="icon-eye-open icon-2x"></i> Witness</a>
						</div>
					</div>

					<div class="row-fluid ui-wizard-row" id="ui-wizard-category" hidden>
						<div class="offset2 span8 natural-language-form">

							<p class="lead text text-center" style="margin: 0;">
								<span id="ui-wizard-victim-text" hidden>I've been a victim of</span>
								<span id="ui-wizard-witness-text" hidden>I've witnessed a</span>
								{% render_field form.category class+="select2 span4" data-style="btn-large boostrap-select-colors-fix" %}
								<!--that happened --><!--on
								{% render_field form.datetime type="datetime-local" class+="span4" required="required" %}-->
								<!--at-->
							</p>

						</div>
					</div>

					<div class="row-fluid ui-wizard-row" id="ui-wizard-location-datetime" hidden>
						<div class="span6">
							<h2><i class="icon-map-marker"></i> Location</h2>
							<div id="map" style="width:100%; height: 300px"></div>
							<!--<input type="text" name="location" id="id_location">-->
							{% render_field form.location type="hidden" %}
							<div class="input-prepend" style="display: block; margin-top: 10px; margin-bottom: 0; text-align: center;">
								<span class="add-on" style="width: 20%;"> <i class="icon-map-marker icon-large"></i> </span>
								{% render_field form.location_text type="text" placeholder="Location" class="input-block-level_" _data-provide="typeahead" _data-source="reform.data.locations" _autocomplete="off" style="width: 70%" %}
							</div>
						</div>
						<div class="span6">
							<h2><i class="icon-calendar"></i><i class="icon-time"></i> Date and Time</h2>
							{% render_field form.datetime type="datetime-local" class+="input-block-level" required="required" style="display: none;" %}
							{#% render_field form.datetime type="hidden" class+="input-block-level" %#}
							<div id="dateinput" style="height: 300px;">
							<script type="text/template" id="dateinput-template">
								<div class="controls">
									<div class="clndr-previous-year-button">&lsaquo;&lsaquo;</div>
									<div class="clndr-previous-button">&lsaquo;</div>
									<div class="month"><%= month %> <%= year %></div>
									<div class="clndr-next-button">&rsaquo;</div>
									<div class="clndr-next-year-button">&rsaquo;&rsaquo;</div>
								</div>
								<div class="clndr-grid">
									<div class="days-of-the-week clearfix">
										<% _.each(daysOfTheWeek, function(day) { %>
											<div class="header-day"><%= day %></div>
										<% }); %>
									</div>
									<div class="days clearfix">
										<% _.each(days, function(day) { %>
											<div class="<%= day.classes %>" id="<%= day.id %>"><span class="day-number"><%= day.day %></span></div>
										<% }); %>
									</div>
								</div>
							</script>
							</div>
							<input id="id_date" name="date" type="hidden">
							<div class="input-prepend" style="display: block; margin-top: 10px; margin-bottom: 0; text-align: center;">
								<span class="add-on" style="width: 20%;"> <i class="icon-time icon-large"></i> </span>
								<input id="id_time" name="time" type="time" class="input-block-level_" style="text-align: center; width: 70%;">
							</div>
						</div>
					</div>

					<div class="row-fluid ui-wizard-row" id="ui-wizard-victim-aggressor" hidden>

						<div class="span6" id="ui-wizard-victim-area">
							<h2><i class="icon-user"></i> Victim</h2>

							<fieldset id="ui-reporter-victim-fieldset" class="ui-victim-fieldset form-horizontal input-area" style="display: none;" disabled>

								{{reporter_victim_form|crispy}}

							</fieldset>

							<fieldset id="ui-witness-victim-fieldset" class="ui-victim-fieldset_ form-horizontal_ input-area_" style="display: none;" disabled>

								<!--{% render_field form.victim placeholder="Victim" class+="select2 input-block-level" %}-->

								<!--{{victim_form|crispy}}-->

								<!--
								<div id="div_id_victim-category" class="control-group">
									<label for="id_victim-category" class="control-label ">Category</label>
									<div class="controls">
										<label class="radio inline">
											<input type="radio" name="victim-category" id="id_victim-category_1" value="CIT" checked> Citizen
										</label>
										<label class="radio inline">
											<input type="radio" name="victim-category" id="id_victim-category_2" value="COP"> Cop
										</label>
									</div>
								</div>
								<div id="div_id_victim-firstname" class="control-group">
									<label for="id_victim-firstname" class="control-label requiredField">Firstname</label>
									<div class="controls"><input class=" " id="id_victim-firstname" maxlength="100" name="victim-firstname" type="text" /> </div>
								</div>
								<div id="div_id_victim-lastname" class="control-group">
									<label for="id_victim-lastname" class="control-label requiredField">Lastname</label>
									<div class="controls"><input class=" " id="id_victim-lastname" maxlength="100" name="victim-lastname" type="text" /> </div>
								</div>
								<div id="div_id_victim-gender" class="control-group">
									<label for="id_victim-gender" class="control-label requiredField">Gender</label>
									<div class="controls">
										<label class="radio inline">
											<input type="radio" name="victim-gender" id="id_victim-gender_1" value="M" checked> Male
										</label>
										<label class="radio inline">
											<input type="radio" name="victim-gender" id="id_victim-gender_2" value="F"> Female
										</label>
									</div>
								</div>
								<div id="div_id_victim-age" class="control-group">
									<label for="id_victim-age" class="control-label requiredField">Age</label>
									<div class="controls"><input class=" " id="id_victim-age" name="victim-age" type="number" /> </div>
								</div>
								<div id="div_id_victim-education" class="control-group">
									<label for="id_victim-education" class="control-label requiredField">Education</label>
									<div class="controls"><input class=" " id="id_victim-education" maxlength="200" name="victim-education" type="text" /> </div>
								</div>
								<div id="div_id_victim-profession" class="control-group">
									<label for="id_victim-profession" class="control-label requiredField">Profession</label>
									<div class="controls"><input class=" " id="id_victim-profession" maxlength="200" name="victim-profession" type="text" /> </div>
								</div>
								<div id="div_id_victim-phone" class="control-group">
									<label for="id_victim-phone" class="control-label requiredField">Phone</label>
									<div class="controls"><input class=" " id="id_victim-phone" maxlength="20" name="victim-phone" type="text" /> </div>
								</div>
								<div id="div_id_victim-email" class="control-group">
									<label for="id_victim-email" class="control-label requiredField">Email</label>
									<div class="controls"><input class=" " id="id_victim-email" maxlength="75" name="victim-email" type="text" /> </div>
								</div>
								-->


								<div class="row-fluid">
									<label for="id_victim-category" class="span4">Category</label>
									<div class="span8">
										<label class="radio inline">
											<input type="radio" name="victim-category" id="id_victim-category_1" value="CIT" checked> Citizen
										</label>
										<label class="radio inline">
											<input type="radio" name="victim-category" id="id_victim-category_2" value="COP"> Cop
										</label>
									</div>
								</div>

								<div class="row-fluid">
									<label for="id_victim-firstname" class="span4">Firstname</label>
									<input class="span8" id="id_victim-firstname" maxlength="100" name="victim-firstname" type="text" />
								</div>

								<div class="row-fluid">
									<label for="id_victim-lastname" class="span4">Lastname</label>
									<input class="span8" id="id_victim-lastname" maxlength="100" name="victim-lastname" type="text" />
								</div>

								<div class="row-fluid">
									<label for="id_victim-gender" class="span4">Gender</label>
									<div class="span8">
										<label class="radio inline">
											<input type="radio" name="victim-gender" id="id_victim-gender_1" value="M" checked> Male
										</label>
										<label class="radio inline">
											<input type="radio" name="victim-gender" id="id_victim-gender_2" value="F"> Female
										</label>
									</div>
								</div>

								<div class="row-fluid">
									<label for="id_victim-age" class="span4">Age</label>
									<input class="span8" id="id_victim-age" name="victim-age" type="number" />
								</div>

								<div class="row-fluid">
									<label for="id_victim-education" class="span4">Education</label>
									<input class="span8" id="id_victim-education" maxlength="200" name="victim-education" type="text" />
								</div>

								<div class="row-fluid">
									<label for="id_victim-profession" class="span4">Profession</label>
									<input class="span8" id="id_victim-profession" maxlength="200" name="victim-profession" type="text" />
								</div>

								<div class="row-fluid">
									<label for="id_victim-phone" class="span4">Phone</label>
									<input class="span8" id="id_victim-phone" maxlength="20" name="victim-phone" type="text" />
								</div>

								<div class="row-fluid">
									<label for="id_victim-email" class="span4">Email</label>
									<input class="span8" id="id_victim-email" maxlength="75" name="victim-email" type="text" />
								</div>

							</fieldset>

						</div>

						<div class="span6" id="ui-wizard-aggressor-area">
							<div>
								<h2 class="pull-left_"><i class="icon-male"></i> Aggressor</h2>
								<!--
								<h2 class="pull-right">
									<a id="ui-aggressor-next" class="btn btn-quiet" title="Next"><i class="icon-arrow-right icon-large"></i></a>
								</h2>
								-->
							</div>
							{% render_field form.aggressor placeholder="Aggressor" class+="input-block-level input-area" %}
						</div>

					</div>

					<div class="row-fluid ui-wizard-row" id="ui-wizard-description-evidence" hidden>
						<div class="span6">
							<h2><i class="icon-ellipsis-horizontal"></i> Description</h2>
							{% render_field form.description placeholder="Description" class+="input-block-level input-area" %}
						</div>
						<div class="span6">
							<h2><i class="icon-picture"></i> Evidence</h2>
							<!--<input name="files[]" type="file" multiple />-->
							<!--<input type="hidden" name="rsid" value="{{report_submit_id}}">-->
							<div id="assets" tabindex="0" class="dropzone input-area" style="background-color: #FFF; border: 1px solid #999;"></div>
							<!--
							<button type="button" class="input-block-level input-area" style="padding: 0;">
								<div id="assets" class="dropzone" style="background-color: #FFF; height: 100%">
								</div>
							</button>
							-->
						</div>
					</div>

					<div class="row-fluid ui-wizard-row" id="ui-wizard-features" hidden>
						<div class="span12">
							<h2><i class="icon-tag"></i> Features</h2>
							<!--<input type="text" class="input-block-level" placeholder="Features">-->
							{% render_field form.features placeholder="Features" class+="select2 input-block-level" data-style="btn-large"  %}
						</div>
					</div>

					<div class="row-fluid ui-wizard-row" id="ui-wizard-submit" hidden>
						<div class="span12">
							<input type="submit" value="Report" class="btn btn-block btn-info btn-large">
						</div>
					</div>

				</div>

			</div>
			<div class="span3">
				<h2><span id="ui-latest-reports-label">Latest</span><span id="ui-similar-reports-label" hidden>Similar</span> Reports</h2>
				<hr>
				<ul id="ui-reports-list" class="list list-hover">
					{% include "reports/submit_similar_reports.html" %}
				</ul>
			</div>
		</div>

	</div>

	</form>


{% endblock %}

{% block view_styles %}

	{% compress css %}
	<!-- Map -->
	<link rel="stylesheet" href="{% static 'components/leaflet/dist/leaflet.css' %}" />
	<!--[if lte IE 8]>
	<link rel="stylesheet" href="{% static 'components/leaflet/dist/leaflet.ie.css' %}" />
	<![endif]-->
	<link rel="stylesheet" href="{% static 'dependencies/L.GeoSearch/src/css/l.geosearch.css' %}" />

	<link rel="stylesheet" href="{% static 'components/dropzone/downloads/css/basic.css' %}" />
	{% endcompress %}

	<link rel="stylesheet" href="{% static 'reports/styles/submit.css'%}" />

{% endblock %}

{% block view_scripts %}
	<!--
	<script src="{% static 'components/angular/angular.js' %}"></script>

	<script src="{% static 'components/angular-resource/angular-resource.js' %}"></script>
	<script src="{% static 'components/angular-cookies/angular-cookies.js' %}"></script>
	<script src="{% static 'components/angular-sanitize/angular-sanitize.js' %}"></script>
	<script src="{% static 'components/ui-router/release/angular-ui-router.js' %}"></script>
	<script src="{% static 'components/angular-bootstrap/ui-bootstrap-tpls.js' %}"></script>

	<script src="{% static 'scripts/app.js' %}"></script>
	<script src="{% static 'reports/scripts/submit-ng.js' %}"></script>
	-->
	{% compress js %}
	<!-- Map -->
	<script src="{% static 'components/leaflet/dist/leaflet.js' %}"></script>
	<script src="{% static 'dependencies/L.GeoSearch/src/js/l.control.geosearch.js' %}"></script>
	<script src="{% static 'dependencies/L.GeoSearch/src/js/l.geosearch.provider.google.js' %}"></script>
	<!-- file upload -->
	<script src="{% static 'components/dropzone/downloads/dropzone.js' %}"></script>
	<!--<script src="{% static 'components/typeahead.js/dist/typeahead.js' %}"></script>-->

	<script src="{% static 'components/lodash/dist/lodash.js' %}"></script>
	<script src="{% static 'components/momentjs/moment.js' %}"></script>
	<script src="{% static 'components/CLNDR/clndr.js' %}"></script>
	{% endcompress %}

	<script type="text/javascript">
		//var report_submit_id = {{report_submit_id|json}};
		//reform.data.victims = {{victims|json}};
		//reform.data.reports = {{reports|json}};
		reform.urls.submit = {% url 'reports:submit' as submit_url %}{{submit_url|json}};
		reform.urls.similar = {% url 'reports:similar_reports' as submit_url %}{{submit_url|json}};
		reform.urls.upload = {% url 'reports:submit-upload' as upload_url %}{{upload_url|json}};
	</script>

	<script src="{% static 'reports/scripts/submit.js' %}"></script>

{% endblock %}
