{% extends "layouts/default.html" %}

{% load static custom crispy_forms_tags widget_tweaks compress l10n %}

{% block view_title %}Thank a Security Officer | {% endblock %}

{% block view_content %}

  <div id="ui-wizard-progress-bar" style="z-index: 900;">
    <div class="container progress progress-info progress-striped">
      <div class="bar animated" id="ui-wizard-progress"></div>
    </div>
  </div>

  <form id="thank-form" action="{% url 'thanks:submit' %}" method="post" enctype="multipart/form-data">
    {% csrf_token %}

  <div class="container">

    {% if form.errors %}
    <div class="alert alert-error">
      <button type="button" class="close" data-dismiss="alert">&times;</button>
      {% for field, errors in form.errors.items %}
        <div>{{field}}:{% for error in errors %} {{error}}{% endfor %}</div>
      {% endfor %}
    </div>
    {% endif %}

    <div class="row-fluid">
      <div class="offset2 span8">
        <div class="well thank-incident-form">

          <div class="row-fluid ui-wizard-row" id="ui-wizard-category">
            <div class="span12">
              <h2>Category</h2>
              {% render_field form.category placeholder="Select a category" class+="select2 _span4 btn-large" data-style="btn-large _boostrap-select-fix" %}
            </div>
          </div>

          <div class="row-fluid ui-wizard-row" id="ui-wizard-location-datetime" hidden>
            <div class="span6">
              <h2><i class="icon-map-marker"></i> Location</h2>
              <div id="map" style="width:100%; height: 300px"></div>
              {% render_field form.latitude type="hidden" %}
              {% render_field form.longitude type="hidden" %}
              {#% render_field form.location type="hidden" %#}
              <input type="hidden" id="id_location" name="location">
              <div class="input-prepend" style="display: block; margin-top: 10px; margin-bottom: 0; text-align: center;">
                <span class="add-on" style="width: 20%;"> <i class="icon-map-marker icon-large"></i> </span>
                {% render_field form.location_text type="text" placeholder="Location" class="input-block-level_" _data-provide="typeahead" _data-source="reform.data.locations" _autocomplete="off" style="width: 70%" %}
              </div>
            </div>
            <div class="span6">
              <h2><i class="icon-calendar"></i><i class="icon-time"></i> Date and Time</h2>
              {% render_field form.datetime type="datetime-local" class+="input-block-level" _required="required" style="display: none;" %}
              {#% render_field form.datetime type="hidden" class+="input-block-level" %#}
              <div id="dateinput" style="height: 300px;">
              <script type="text/template" id="dateinput-template">
                <div class="controls">
                  <div class="clndr-previous-year-button">&lsaquo;&lsaquo;</div>
                  <div class="clndr-previous-button">&lsaquo;</div>
                  <div class="month"><%= month %> <%= year %></div>
                  <div class="clndr-next-button">&rsaquo;</div>
                  <div class="clndr-next-year-button">&rsaquo;&rsaquo;</div>
                </div>
                <div class="clndr-grid">
                  <div class="days-of-the-week clearfix">
                    <% _.each(daysOfTheWeek, function(day) { %>
                      <div class="header-day muted"><strong><%= day %></strong></div>
                    <% }); %>
                  </div>
                  <div class="days clearfix">
                    <% _.each(days, function(day) { %>
                      <div class="<%= day.classes %>" id="<%= day.id %>"><span class="day-number"><%= day.day %></span></div>
                    <% }); %>
                  </div>
                </div>
              </script>
              </div>
              <input id="id_date" name="date" type="hidden">
              <div class="input-prepend" style="display: block; margin-top: 10px; margin-bottom: 0; text-align: center;">
                <span class="add-on" style="width: 20%;"> <i class="icon-time icon-large"></i> </span>
                <input id="id_time" name="time" type="time" class="input-block-level_" style="text-align: center; width: 70%;" placeholder="Time">
              </div>
            </div>
          </div>

          <div class="row-fluid ui-wizard-row" id="ui-wizard-description-evidence" hidden>
            <div class="span6">
              <h2><i class="icon-ellipsis-horizontal"></i> Description</h2>
              {% render_field form.description placeholder="Description" class+="input-block-level input-area" %}
            </div>
            <div class="span6">
              <h2><i class="icon-picture"></i> Photos</h2>
              <div id="ui-evidence-file-upload" tabindex="0" class="dropzone input-area" style="background-color: #FFF; border: 1px solid #999;"></div>
              <!--
              <button type="button" class="input-block-level input-area" style="padding: 0;">
                <div id="ui-evidence-file-upload" class="dropzone" style="background-color: #FFF; height: 100%">
                </div>
              </button>
              -->
            </div>
          </div>

          <div class="row-fluid ui-wizard-row" id="ui-wizard-submit" style="margin-top: 20px;"
} hidden>
            <div class="span12">
              <button class="btn btn-success btn-block btn-large"><i class="icon-plus"></i> Thank</button>
            </div>
          </div>

        </div>
      </div>
    </div>

  </div>

  </form>

{% endblock %}

{% block view_styles %}

  {% compress css %}
  <!-- Map -->
  <link rel="stylesheet" href="{% static 'components/leaflet/dist/leaflet.css' %}" />
  <!--[if lte IE 8]>
  <link rel="stylesheet" href="{% static 'components/leaflet/dist/leaflet.ie.css' %}" />
  <![endif]-->
  <link rel="stylesheet" href="{% static 'dependencies/L.GeoSearch/src/css/l.geosearch.css' %}" />

  <link rel="stylesheet" href="{% static 'components/dropzone/downloads/css/basic.css' %}" />
  {% endcompress %}

  {% compress css %}
  <link rel="stylesheet" href="{% static 'thanks/styles/submit.css'%}" />
  {% endcompress %}

{% endblock %}

{% block view_scripts %}
  {% compress js %}
  <!-- UI Block -->
  <script src="{% static 'components/blockui/jquery.blockUI.js' %}"></script>
  <script type="text/javascript">$.blockUI.defaults.baseZ = 800;</script>
  <!-- Map -->
  <script src="{% static 'components/leaflet/dist/leaflet.js' %}"></script>
  <script type="text/javascript">L.Icon.Default.imagePath = "{% static 'components/leaflet/dist/images' %}";</script>
  <script src="{% static 'dependencies/L.GeoSearch/src/js/l.control.geosearch.js' %}"></script>
  <script src="{% static 'dependencies/L.GeoSearch/src/js/l.geosearch.provider.google.js' %}"></script>
  <!-- file upload -->
  <script src="{% static 'components/dropzone/downloads/dropzone.js' %}"></script>
  <!--<script src="{% static 'components/typeahead.js/dist/typeahead.js' %}"></script>-->
  <!-- date input -->
  <script src="{% static 'components/lodash/dist/lodash.js' %}"></script>
  <script src="{% static 'components/momentjs/moment.js' %}"></script>
  <script src="{% static 'components/CLNDR/clndr.js' %}"></script>
  {% endcompress %}

  <script type="text/javascript">
    reform.urls.submit = {% url 'thanks:submit' as submit_url %}{{submit_url|json}};
  </script>

  {% compress js %}
  <script src="{% static 'thanks/scripts/submit.js' %}"></script>
  {% endcompress %}

{% endblock %}
