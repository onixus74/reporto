{% extends "layouts/default.html" %}

{% load static custom thumbnail compress %}

{% block view_title %}Thank Details | {% endblock %}

{% block view_content %}
<div class="container">

  <div class="page-header">
    <h1 class="text-center">Thank View<small></small></h1>
  </div>


  <div class="well">

    <div class="container-fluid">

      <div class="row-fluid">
        <div class="offset2 span8">
          <hr>
          <h2 class="text-center">
            {{thankreport.category}} on {{thankreport.datetime}} at {{thankreport.location_text}}
            {% if user.is_admin %}<a class="btn btn-warning" href="/admin/incidents/thankreport/{{thankreport.id}}" target="_blank"><i class="icon-pencil"></i> Edit</a>{% endif %}
          </h2>
        </div>
      </div>

      <div class="row-fluid">
        <div class="offset2 span8">
          <div id="map" style="width:100%; height: 300px"></div>
          <!--<p class="text-center">{{thankreport.location_text}}</p>-->
        </div>
      </div>

      <div class="row-fluid">
        <div class="span6">
          <hr>
          <h2><i class="icon-ellipsis-horizontal"></i> Description</h2>
          <p>{{thankreport.description|urlize}}</p>
        </div>
        <div class="span6">
          <hr>
          <h2><i class="icon-picture"></i> Photos</h2>{% get_media_prefix as MEDIA_PREFIX %}
          {% if thankreport.media.count %}
          <ul class="thumbnails">
            {% for media in thankreport.media.all %}
            <li class="span4_" style="display: inline-block; width: auto;">
              {% comment %}
              <a class="thumbnail- fancybox" href="{% if media.is_file %}{{ media.file.url }}{% else %}{{media.url}}{% endif %}" target="_blank" rel="group">
              {% endcomment %}
              <a class="thumbnail- fancybox" href="{{media.url}}" target="_blank" rel="group">
                <img src="{% if media.is_file %}{{ media.file|thumbnail_url:'media' }}{% elif media.is_youtube %}{{media.get_youtube_thumbnail}}{% else %}{{media.url}}{% endif %}" alt="" style="height: 100px; width: auto;" class="img-polaroid">
              </a>
            </li>
            {% endfor %}
          </ul>
          {% else %}
          <span>No attachments!</span>
          {% endif %}
        </div>
      </div>

    </div>

  </div>


</div>
{% endblock %}

{% block view_styles %}

  {% compress css %}
  <!-- Map -->
  <link rel="stylesheet" href="{% static 'components/leaflet/dist/leaflet.css' %}" />
  <!-- Lightbox -->
  <link rel="stylesheet" href="{% static 'components/fancybox/source/jquery.fancybox.css' %}" type="text/css" />
  <link rel="stylesheet" href="{% static 'components/fancybox/source/helpers/jquery.fancybox-thumbs.css' %}" type="text/css" />
  {% endcompress %}

  {% compress css %}
  {% comment %}<link rel="stylesheet" href="{% static 'thanks/styles/view.css'%}" />{% endcomment %}
  {% endcompress %}

{% endblock %}

{% block view_scripts %}

  {% compress js %}
  <!-- Map -->
  <script src="{% static 'components/leaflet/dist/leaflet.js' %}"></script>
  <script type="text/javascript">L.Icon.Default.imagePath = "{% static 'components/leaflet/dist/images' %}";</script>
  <!-- Lightbox -->
  <script type="text/javascript" src="{% static 'components/fancybox/source/jquery.fancybox.js' %}"></script>
  <script type="text/javascript" src="{% static 'components/fancybox/source/helpers/jquery.fancybox-media.js' %}"></script>
  <script type="text/javascript" src="{% static 'components/fancybox/source/helpers/jquery.fancybox-thumbs.js' %}"></script>
  {% endcompress %}

  <script type="text/javascript">
    reform.data.thank = {{thankreport|json}}
    $(function(){

      //$(".fancybox").fancybox();

      $(".fancybox").fancybox({
        helpers : {
          media : {},
          thumbs  : {
            width : 50,
            height  : 50
          },
        }
      });

      $(".fancybox-thumb").fancybox({
        prevEffect  : 'none',
        nextEffect  : 'none',
        helpers : {
          /*title : {
            type: 'outside'
          },*/
          thumbs  : {
            width : 50,
            height  : 50
          }
        }
      });

      $('.fancybox-media').fancybox({
        /*
        openEffect  : 'none',
        closeEffect : 'none',
        */
        helpers : {
          media : {}
        }
      });
    });
  </script>


  {% compress js %}
  <script src="{% static 'thanks/scripts/view.js' %}"></script>
  {% endcompress %}

{% endblock %}
